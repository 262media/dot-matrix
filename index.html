<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Dot MatrixðŸ”¥</title>
        <link href="https://fonts.googleapis.com/css?family=Cutive+Mono&display=swap" rel="stylesheet">
        <link href="demo.css" rel="stylesheet">
    </head>
    <body>
        <div class="controls">
            <p>Dot Count: <span class="count"></span></p>
            <small>Note: height & width values <br>will override cols and rows</small>
            <br>
            <br>
            <label for="height">height
                <input type="text" name="height" placeholder="height" value="0"/>
            </label>

            <label for="width">width
                <input type="text" name="width" placeholder="width" value="0"/>
            </label>

            <label for="spacing">spacing
                <input type="range" min="0" max="1000" name="spacing" placeholder="spacing" value="50"/>
            </label>

            <label for="padding">padding
                <input type="range" min="0" name="padding" placeholder="padding" value="50"/>
            </label>

            <label for="rows">rows
                <input type="range" min="0" max="200" name="rows" placeholder="rows" value="10"/>
            </label>

            <label for="columns">columns
                <input type="range" min="0" max="200" name="columns" placeholder="columns" value="30"/>
            </label>

            <label for="delay">delay
                <input type="range" min="0" max="10000" name="delay" placeholder="delay" value="200"/>
            </label>

            <label for="step-distance">step distance
                <input type="range" min="10" max="1000" name="step-distance" placeholder="step distance" value="10"/>
            </label>

            <label for="fear-distance">fear distance
                <input type="range" min="0" max="1000" name="fear-distance" placeholder="fear distance" value="100"/>
            </label>

            <label for="backgroundColor">backgroundColor
                <input type="text" name="backgroundColor" placeholder="HEX or string" value=""/>
            </label>

            <label for="dotRadius">dotRadius
                <input type="range" min="1" name="dotRadius" placeholder="dotRadius" value="5"/>
            </label>

            <label for="dotFillColor">dotFillColor
                <input type="text" name="dotFillColor" placeholder="HEX or string" value=""/>
            </label>
            <br>
            <p>Example Presets</p>
            <button class="moderate_dots_spacing">moderate_dots_spacing</button>
            <button class="tenK_smalls_dots">tenK_smalls_dots</button>
            <button class="spaced_large_dots">spaced_large_dots</button>
            <button class="spaced_medium_dots">spaced_medium_dots</button>
            <button class="dense_group">dense_group</button>
            <br>
            <p>Config Object(In JSON)</p>
            <pre class="config"></pre>

        </div>
        <div class="wrapper">
            <h1>Dot Matrix</h1>
            <svg class="dot-matrix" width="100%" height="100%"></svg>
        </div>
        <script src="coordinate-translator.js"></script>
        <script src="smart-dot.js"></script>
        <script src="dot-matrix.js"></script>
        <script src="examples.js"></script>
        <script src="demo-dimensions.js"></script>
        <script>
            (() => {
                if (window.innerWidth <= 991) {
                    const controls = document.querySelector('.controls');
                    controls.remove();
                    const wrapper = document.querySelector('.wrapper');
                    wrapper.style.margin = 0;
                    const svg = document.querySelector('.dot-matrix');
                    svg.style.border = 'none';
                    new DotMatrix(
                        svg,
                        {
                            padding: 18,
                            spacing: 15,
                            // rows: 19,
                            // columns: 9,
                            height: window.innerHeight - 27,
                            width: window.innerWidth,
                            svgBackgroundColor: "white",
                            DOT_RADIUS: 5,
                            DOT_FILL_COLOR: "diagonal",
                            DISTANCE_TO_FEAR: 50,
                            DISTANCE_TO_STEP: 25,
                            DELAY_BEFORE_GOING_HOME: 500,
                            CSS_CLASS_GOING_HOME: "animate_going_home",
                            timing: {
                                fromHome: "ease",
                                backHome: "ease"
                            },
                            duration: {
                                fromHome: "0.1s",
                                backHome: "1s"
                            }
                        }
                    );

                    return false;
                }

                let timeout;
                const count = document.querySelector('.count');
                count.innerHTML = 30 * 10;
                const config = document.querySelector('.config');

                config.innerHTML = JSON.stringify({
                    padding: 50,
                    spacing: 50,
                    width: window.adjustedWidth,
                    height: window.innerHeight,
                    rows: 10,
                    columns: 30,
                    svgBackgroundColor: 'white',
                    DISTANCE_TO_FEAR: 100,
                    DISTANCE_TO_STEP: 10,
                    DELAY_BEFORE_GOING_HOME: 200,
                    DOT_RADIUS: 5,
                    DOT_COLOR_PATTERN: 'random',
                    PATTERN_COLORS: [
                        'red',
                        'orange',
                        'yellow',
                        'green',
                        'cyan',
                        'skyblue',
                        'blue',
                        'indigo',
                        'violet',
                        'lightgrey',
                    ],
                    CSS_CLASS_GOING_HOME: 'animate_going_home',
                    timing: {
                        fromHome: 'ease',
                        backHome: 'ease',
                    },
                    duration: {
                        fromHome: '0.1s',
                        backHome: '1s',
                    },
                }, undefined, 2);

                const wrapper = document.querySelector('.wrapper');
                wrapper.style.width = `${window.adjustedWidth}px`;
                wrapper.style.height = `${window.innerHeight}px`;

                const matrix = new DotMatrix(
                    document.querySelector('.dot-matrix'),
                    {
                        padding: 50,
                        spacing: 60,
                        // rows: 10,
                        // columns: 20,
                        width: window.adjustedWidth,
                        height: window.innerHeight,
                        svgBackgroundColor: 'white',
                        DISTANCE_TO_FEAR: 100,
                        DISTANCE_TO_STEP: 10,
                        DELAY_BEFORE_GOING_HOME: 200,
                        DOT_RADIUS: 5,

                        DOT_COLOR_PATTERN: 'diagonal',
                        PATTERN_COLORS: [
                            'red',
                            'orange',
                            'yellow',
                            'green',
                            'cyan',
                            'skyblue',
                            'blue',
                            'indigo',
                            'violet',
                            'lightgray',
                        ],
                        CSS_CLASS_GOING_HOME: 'animate_going_home',
                        timing: {
                            fromHome: 'ease',
                            backHome: 'ease',
                        },
                        duration: {
                            fromHome: '0.1s',
                            backHome: '1s',
                        },
                    }
                );

                Array.from(document.querySelectorAll('input')).forEach(input => {
                    if (input.type === 'range') {
                        input.addEventListener('change', () => {
                            document.dispatchEvent(new Event('matrix_reload'));
                        });
                        return false;
                    }

                    input.addEventListener('keyup', () => {
                        if (timeout) clearTimeout(timeout);
                        timeout = setTimeout(() => {
                            document.dispatchEvent(new Event('matrix_reload'));
                        }, 250)
                    });
                });

                Array.from(document.querySelectorAll('button')).forEach(button => {
                    button.addEventListener('click', () => {
                        document.dispatchEvent(new CustomEvent('matrix_reload', {
                            detail: {
                                config: button.classList.value,
                            }
                        }));
                    });
                });

                document.addEventListener('matrix_reload', (e) => {
                    e.preventDefault();
                    e.stopPropagation();

                    delete matrix;
                    const height = parseInt(document.querySelector('input[name="height"]').value);
                    const width = parseInt(document.querySelector('input[name="width"]').value);
                    const spacing = parseInt(document.querySelector('input[name="spacing"]').value);
                    const padding = parseInt(document.querySelector('input[name="padding"]').value);
                    const columns = parseInt(document.querySelector('input[name="columns"]').value) || 1;
                    const rows = parseInt(document.querySelector('input[name="rows"]').value) || 1;
                    const fear = parseInt(document.querySelector('input[name="fear-distance"]').value);
                    const delay = parseInt(document.querySelector('input[name="delay"]').value);
                    const step = parseInt(document.querySelector('input[name="step-distance"]').value);

                    const backgroundColor = document.querySelector('input[name="backgroundColor"]').value || 'white';
                    const dotRadius = parseInt(document.querySelector('input[name="dotRadius"]').value);
                    const dotFillColor = document.querySelector('input[name="dotFillColor"]').value || 'random';

                    const wrapper = document.querySelector('.wrapper');
                    wrapper.style.width = `${window.adjustedWidth}px`;
                    wrapper.style.height = `${window.innerHeight}px`;

                    const svg = document.querySelector('.dot-matrix');
                    const config = document.querySelector('.config');
                    count.innerHTML = rows * columns;

                    const configObject = {
                        width: window.adjustedWidth,
                        height: window.innerHeight,
                        padding,
                        spacing,
                        // rows,
                        // columns,
                        svgBackgroundColor: backgroundColor,
                        DOT_RADIUS: dotRadius,
                        DOT_FILL_COLOR: dotFillColor,
                        DISTANCE_TO_FEAR: fear,
                        DISTANCE_TO_STEP: step,
                        DELAY_BEFORE_GOING_HOME: !!delay === false ? false : delay,
                        CSS_CLASS_GOING_HOME: 'animate_going_home',
                        timing: {
                            fromHome: 'ease',
                            backHome: 'ease',
                        },
                        duration: {
                            fromHome: '0.1s',
                            backHome: '1s',
                        },
                    };

                    config.innerHTML = JSON.stringify(configObject, undefined, 2);
                    svg.remove();
                    const newSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    newSvg.classList = 'dot-matrix';
                    wrapper.appendChild(newSvg);

                    if (e.detail) {
                        new DotMatrix(newSvg, window[e.detail.config]);
                        return false;
                    }

                    new DotMatrix(
                        newSvg,
                        configObject
                    )
                });
            })();
        </script>
    </body>
</html>