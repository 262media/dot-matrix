<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Dot MatrixðŸ”¥</title>
        <link href="https://fonts.googleapis.com/css?family=Cutive+Mono&display=swap" rel="stylesheet">
        <link href="demo.css" rel="stylesheet">
    </head>
    <body>
        <div class="controls">
            <p>Dot Count: <span class="count"></span></p>
            <small>Note: height & width values <br>will override cols and rows</small>
            <br>
            <br>
            <label for="height">height
                <input type="text" name="height" placeholder="height" value="0"/>
            </label>

            <label for="width">width
                <input type="text" name="width" placeholder="width" value="0"/>
            </label>

            <label for="spacing">spacing
                <input type="range" min="0" max="1000" name="spacing" placeholder="spacing" value="50"/>
            </label>

            <label for="padding">padding
                <input type="range" min="0" name="padding" placeholder="padding" value="50"/>
            </label>

            <label for="rows">rows
                <input type="range" min="0" max="200" name="rows" placeholder="rows" value="10"/>
            </label>

            <label for="columns">columns
                <input type="range" min="0" max="200" name="columns" placeholder="columns" value="30"/>
            </label>

            <label for="delay">delay
                <input type="range" min="0" max="10000" name="delay" placeholder="delay" value="200"/>
            </label>

            <label for="step-distance">step distance
                <input type="range" min="10" max="1000" name="step-distance" placeholder="step distance" value="10"/>
            </label>

            <label for="fear-distance">fear distance
                <input type="range" min="0" max="1000" name="fear-distance" placeholder="fear distance" value="100"/>
            </label>

            <label for="backgroundColor">backgroundColor
                <input type="text" name="backgroundColor" placeholder="HEX or string" value=""/>
            </label>

            <label for="dotRadius">dotRadius
                <input type="range" min="1" name="dotRadius" placeholder="dotRadius" value="5"/>
            </label>

            <label for="dotFillColor">dotFillColor
                <input type="text" name="dotFillColor" placeholder="HEX or string" value=""/>
            </label>
            <br>
            <p>Example Presets</p>
            <button class="moderate_dots_spacing">moderate_dots_spacing</button>
            <button class="tenK_smalls_dots">tenK_smalls_dots</button>
            <button class="spaced_large_dots">spaced_large_dots</button>
            <button class="spaced_medium_dots">spaced_medium_dots</button>
            <button class="dense_group">dense_group</button>
            <br>
            <p>Config Object(In JSON)</p>
            <pre class="config"></pre>
        </div>
        <div class="wrapper">
            <h1>Dot Matrix</h1>
            <svg class="dot-matrix" width="100%" height="100%"></svg>
        </div>
        <script src="coordinate-translator.js"></script>
        <script src="smart-dot.js"></script>
        <script src="dot-matrix.js"></script>
        <script src="examples.js"></script>
        <script src="demo-dimensions.js"></script>
        <script src="controls-listeners.js"></script>
        <script src="mobile-demo.js"></script>
        <script src="clean-class-object.js"></script>
        <script>
            (() => {
                //--------------------------------------------------------
                //--------------------------------------------------------
                // Vars
                const controls = document.querySelector('.controls');
                const wrapper = document.querySelector('.wrapper');
                const svg = document.querySelector('.dot-matrix');
                const count = document.querySelector('.count');
                const config = document.querySelector('.config');
                let timeout;

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Mobile Settings
                if (window.innerWidth <= 991) {
                    mobileDemo({
                        svg,
                        controls,
                        wrapper
                    });

                    return false;
                }

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Update size for fullscreen considering the controls
                const adjustedWidth = demoDimensions();

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Kick it off
                window.matrix = new DotMatrix(
                    document.querySelector('.dot-matrix'),
                    {
                        padding: 50,
                        spacing: 20,
                        width: adjustedWidth,
                        height: window.innerHeight,
                        svgBackgroundColor: 'white',
                        distanceToFear: 100,
                        distanceToStep: 10,
                        delayBeforeGoingHome: 200,
                        dotRadius: 5,
                        dotColorPattern: 'diagonal',
                        patternColors: [
                            'red',
                            'orange',
                            'yellow',
                            'green',
                            'cyan',
                            'skyblue',
                            'blue',
                            'indigo',
                            'violet',
                            'lightgray',
                        ],
                        cssClassGoingHome: 'animate_going_home',
                        timing: {
                            fromHome: 'ease',
                            backHome: 'ease',
                        },
                        duration: {
                            fromHome: '0.1s',
                            backHome: '1s',
                        },
                    }
                );

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Clean class object
                const cleanObject = cleanObjectClass(window.matrix);

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Print initial return object from DotMatrix
                config.innerHTML = JSON.stringify(cleanObject, undefined, 2);
                count.innerHTML = parseInt(cleanObject.rows) * parseInt(cleanObject.columns);

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Adjust wrapper width
                wrapper.style.width = `${adjustedWidth}px`;
                wrapper.style.height = `${window.innerHeight}px`;

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Set Controls Listeners
                controlsListeners();

                //--------------------------------------------------------
                //--------------------------------------------------------
                // Custom Event Listener
                document.addEventListener('matrix_reload', (e) => {
                    // Performance
                    e.preventDefault();
                    e.stopPropagation();

                    // Vars from controls
                    const height = parseInt(document.querySelector('input[name="height"]').value);
                    const width = parseInt(document.querySelector('input[name="width"]').value);
                    const spacing = parseInt(document.querySelector('input[name="spacing"]').value);
                    const padding = parseInt(document.querySelector('input[name="padding"]').value);
                    const columns = parseInt(document.querySelector('input[name="columns"]').value) || 1;
                    const rows = parseInt(document.querySelector('input[name="rows"]').value) || 1;
                    const fear = parseInt(document.querySelector('input[name="fear-distance"]').value);
                    const delay = parseInt(document.querySelector('input[name="delay"]').value);
                    const step = parseInt(document.querySelector('input[name="step-distance"]').value);
                    const backgroundColor = document.querySelector('input[name="backgroundColor"]').value || 'white';
                    const dotRadius = parseInt(document.querySelector('input[name="dotRadius"]').value);
                    const dotFillColor = document.querySelector('input[name="dotFillColor"]').value || 'random';

                    wrapper.style.width = `${adjustedWidth}px`;
                    wrapper.style.height = `${window.innerHeight}px`;

                    // Old svg
                    const svg = document.querySelector('.dot-matrix');
                    // Remove old svg
                    svg.remove();

                    // Create new svg, add class and append to wrapper
                    const newSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    newSvg.classList = 'dot-matrix';
                    wrapper.appendChild(newSvg);

                    // Delete old class
                    delete window.matrix

                    // New Config object
                    const configObject = {
                        width: adjustedWidth,
                        height: window.innerHeight,
                        padding,
                        spacing,
                        svgBackgroundColor: backgroundColor,
                        dotRadius: dotRadius,
                        dotFillColor: dotFillColor,
                        distanceToFear: fear,
                        distanceToStep: step,
                        delayBeforeGoingHome: !!delay === false ? false : delay,
                        cssClassGoingHome: 'animate_going_home',
                        timing: {
                            fromHome: 'ease',
                            backHome: 'ease',
                        },
                        duration: {
                            fromHome: '0.1s',
                            backHome: '1s',
                        },
                    };

                    // Kick it off
                    window.matrix = new DotMatrix(
                        newSvg,
                        e.detail ? window[e.detail.config] : configObject,
                    );

                    // Print config json and update dot count
                    config.innerHTML = JSON.stringify(cleanObject, undefined, 2);
                    count.innerHTML = parseInt(cleanObject.rows) * parseInt(cleanObject.columns);
                });
            })();
        </script>
    </body>
</html>